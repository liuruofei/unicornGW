<form id="modelUserForm" lay-filter="modelUserForm" class="layui-form model-form">
    <div class="layui-form-item">
        <label class="layui-form-label">上传缩略图:</label>
        <div class="layui-input-block">
            <button type="button" class="layui-btn" id="img_url">上传图片(826*526)</button>
            <div class="layui-upload-list file-list">
            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">中文正文</label>
        <div class="layui-input-block">
            <script id="contents" type="text/plain" style="height:500px;">
            </script>
        </div>
    </div>
    <div class="layui-form-item positionbottomtop"></div>
    <div class="layui-form-item text-right positionbottom">
        <button class="layui-btn layui-btn-primary" type="button" ew-event="closeDialog">取消</button>
        <button class="layui-btn" lay-filter="modelUserSubmit" lay-submit>保存</button>
    </div>
</form>

@section css{
}

@section js{
    <!-- js部分 -->
    <script src="~/assets/nUeditor/neditor.config.js"></script>
    <!-- 编辑器源码文件 -->
    <script src="~/assets/nUeditor/neditor.all.min.js"></script>
    <script src="~/assets/nUeditor/i18n/zh-cn/zh-cn.js"></script>
    <script>
        var editor = UE.getEditor('contents');
    layui.use([ 'form', 'admin', 'adminForm'], function () {
        var $ = layui.jquery;
        var form = layui.form;
        var admin = layui.admin;
        var adminForm = layui.adminForm;

        admin.initUploadImg({
            elem: '#img_url',
            done: function (res, index, upload) {
                admin.initBindImg({
                    key: 'img_url',
                    data: res.data,
                    number: 1
                });
            }
        });

        var App = {
            Load: function () {
                adminForm.load({
                    formName: 'modelUserForm',
                    url: "@Url.Action("Find")",
                    dataType: 'json',
                    callBack: function (r) {
                        admin.initBindImg({
                            key: 'img_url',
                            data: r.img_url,
                            number: 1
                        });
                        if (r.contents) {
                            //编辑器 配置
                            editor.ready(function () {
                                editor.addListener('blur', function (editor) {
                                });
                                editor.setContent(r.contents.replace(/'/g, '\''));
                            });
                        }
                    }
                });
            },
            Save: function (data) {
                data.field.contents = editor.getContent();
                data.field.contentsen = editoren.getContent();
                console.log(data);
            }
        }
        App.Load();
        // 表单提交事件
        form.on('submit(modelUserSubmit)', function (data) {
            App.Save(data);
            return false;
        });
    });
    </script>
}